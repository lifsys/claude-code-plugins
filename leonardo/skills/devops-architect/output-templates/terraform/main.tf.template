# Terraform Configuration Template
# Generated by: DevOps-Architect (Leonardo Plugin)
#
# This is a template - replace placeholders with actual values
# Customize based on chosen platform and requirements

terraform {
  required_version = ">= 1.5.0"

  required_providers {
    # Uncomment providers as needed

    # AWS Provider
    # aws = {
    #   source  = "hashicorp/aws"
    #   version = "~> 5.0"
    # }

    # Google Cloud Provider
    # google = {
    #   source  = "hashicorp/google"
    #   version = "~> 5.0"
    # }

    # Vercel Provider
    # vercel = {
    #   source  = "vercel/vercel"
    #   version = "~> 1.0"
    # }
  }

  # Backend configuration for state storage
  # Uncomment and configure for team usage
  # backend "s3" {
  #   bucket         = "terraform-state-${PROJECT_NAME}"
  #   key            = "infrastructure/terraform.tfstate"
  #   region         = "us-east-1"
  #   encrypt        = true
  #   dynamodb_table = "terraform-locks"
  # }
}

# =============================================================================
# Variables
# =============================================================================

variable "project_name" {
  description = "Project name used for resource naming"
  type        = string
  default     = "${PROJECT_NAME}"
}

variable "environment" {
  description = "Deployment environment"
  type        = string
  default     = "production"

  validation {
    condition     = contains(["development", "staging", "production"], var.environment)
    error_message = "Environment must be development, staging, or production."
  }
}

variable "region" {
  description = "Primary deployment region"
  type        = string
  default     = "${PRIMARY_REGION}"
}

# =============================================================================
# AWS Configuration (if using AWS)
# =============================================================================

# provider "aws" {
#   region = var.region
#
#   default_tags {
#     tags = {
#       Project     = var.project_name
#       Environment = var.environment
#       ManagedBy   = "terraform"
#     }
#   }
# }

# # VPC for the application
# module "vpc" {
#   source  = "terraform-aws-modules/vpc/aws"
#   version = "~> 5.0"
#
#   name = "${var.project_name}-vpc"
#   cidr = "10.0.0.0/16"
#
#   azs             = ["${var.region}a", "${var.region}b"]
#   private_subnets = ["10.0.1.0/24", "10.0.2.0/24"]
#   public_subnets  = ["10.0.101.0/24", "10.0.102.0/24"]
#
#   enable_nat_gateway = true
#   single_nat_gateway = var.environment != "production"
# }

# # RDS PostgreSQL Database
# module "rds" {
#   source  = "terraform-aws-modules/rds/aws"
#   version = "~> 6.0"
#
#   identifier = "${var.project_name}-db"
#
#   engine               = "postgres"
#   engine_version       = "15"
#   family               = "postgres15"
#   major_engine_version = "15"
#   instance_class       = var.environment == "production" ? "db.t3.small" : "db.t3.micro"
#
#   allocated_storage = 20
#
#   db_name  = replace(var.project_name, "-", "_")
#   username = "admin"
#   port     = 5432
#
#   vpc_security_group_ids = [aws_security_group.rds.id]
#   subnet_ids             = module.vpc.private_subnets
#
#   backup_retention_period = var.environment == "production" ? 7 : 1
#   deletion_protection     = var.environment == "production"
# }

# =============================================================================
# Vercel Configuration (if using Vercel)
# =============================================================================

# provider "vercel" {
#   # API token from VERCEL_API_TOKEN environment variable
# }

# resource "vercel_project" "app" {
#   name      = var.project_name
#   framework = "nextjs"  # or "vite", "remix", etc.
#
#   git_repository = {
#     type = "github"
#     repo = "${GITHUB_ORG}/${GITHUB_REPO}"
#   }
#
#   environment = [
#     {
#       key    = "DATABASE_URL"
#       value  = var.database_url
#       target = ["production", "preview"]
#     },
#     {
#       key    = "JWT_SECRET"
#       value  = var.jwt_secret
#       target = ["production", "preview"]
#     }
#   ]
# }

# resource "vercel_project_domain" "production" {
#   project_id = vercel_project.app.id
#   domain     = "${PRODUCTION_DOMAIN}"
# }

# =============================================================================
# Google Cloud Configuration (if using GCP)
# =============================================================================

# provider "google" {
#   project = var.gcp_project_id
#   region  = var.region
# }

# # Cloud Run Service
# resource "google_cloud_run_v2_service" "app" {
#   name     = var.project_name
#   location = var.region
#
#   template {
#     containers {
#       image = "gcr.io/${var.gcp_project_id}/${var.project_name}:latest"
#
#       resources {
#         limits = {
#           cpu    = "1"
#           memory = "512Mi"
#         }
#       }
#
#       env {
#         name  = "DATABASE_URL"
#         value = var.database_url
#       }
#     }
#
#     scaling {
#       min_instance_count = 0
#       max_instance_count = 10
#     }
#   }
# }

# # Allow unauthenticated access
# resource "google_cloud_run_service_iam_member" "public" {
#   service  = google_cloud_run_v2_service.app.name
#   location = var.region
#   role     = "roles/run.invoker"
#   member   = "allUsers"
# }

# =============================================================================
# Outputs
# =============================================================================

# output "app_url" {
#   description = "Application URL"
#   value       = "https://${PRODUCTION_DOMAIN}"
# }

# output "database_endpoint" {
#   description = "Database connection endpoint"
#   value       = module.rds.db_instance_endpoint
#   sensitive   = true
# }
